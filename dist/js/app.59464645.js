(function(e){function t(t){for(var i,n,l=t[0],o=t[1],c=t[2],f=0,p=[];f<l.length;f++)n=l[f],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&p.push(s[n][0]),s[n]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,c||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],i=!0,l=1;l<r.length;l++){var o=r[l];0!==s[o]&&(i=!1)}i&&(a.splice(t--,1),e=n(n.s=r[0]))}return e}var i={},s={app:0},a=[];function n(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=i,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=o;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},2395:function(e,t,r){},4317:function(e,t,r){"use strict";r("8216")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var i=r("2b0e"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},a=[],n=(r("7c55"),r("2877")),l={},o=Object(n["a"])(l,s,a,!1,null,null,null),c=o.exports,d=r("8c4f"),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",[r("el-button",{attrs:{type:"text"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(e._s(e.buttonName))]),r("el-dialog",{attrs:{title:"选择",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("actor-selector",{attrs:{datas:e.actorInitData,"select-tags":e.actorSelectedData,dataProvider:e.dataProvider},on:{confirm:e.onActorConfirm,cancel:function(t){e.dialogVisible=!1}}})],1)],1)])},p=[],h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"tag"},e._l(e.tags,(function(t){return r("el-tag",{key:t.type+t.id,attrs:{closable:"",effect:"plain",type:"info"},on:{close:function(r){return e.tagClose(t)}}},[e._v(" "+e._s(t.name)+" ")])})),1),r("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[e.tabs.indexOf("dept")>=0?r("el-tab-pane",{attrs:{label:"部门",name:"dept"}},[r("el-input",{staticClass:"filter",attrs:{placeholder:"搜索部门",clearable:""},on:{input:e.filterDeptChanged},model:{value:e.filterDept,callback:function(t){e.filterDept=t},expression:"filterDept"}},[r("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"prefix"},slot:"prefix"})]),r("div",{staticClass:"border"},[r("div",{staticClass:"treeHeight"},[r("el-tree",{directives:[{name:"show",rawName:"v-show",value:""!==e.filterDept,expression:"filterDept!==''"}],ref:"tDept2",attrs:{"node-key":"id",props:e.propsTree,"show-checkbox":"",data:e.filterDepts},on:{check:e.handleTreeCheckChanged}}),r("el-tree",{directives:[{name:"show",rawName:"v-show",value:""===e.filterDept,expression:"filterDept===''"}],ref:"tDept1",attrs:{"node-key":"id",props:e.propsTree,"show-checkbox":"","check-strictly":!0,load:e.loadDepts,lazy:"","default-expanded-keys":e.expandedDepts},on:{check:e.handleTreeCheckChanged}})],1)])],1):e._e(),e.tabs.indexOf("user")>=0?r("el-tab-pane",{attrs:{label:"人员",name:"user"}},[r("el-input",{staticClass:"filter",attrs:{placeholder:"搜索人员",clearable:""},on:{input:e.filterUserChanged},model:{value:e.filterUser,callback:function(t){e.filterUser=t},expression:"filterUser"}},[r("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"prefix"},slot:"prefix"})]),r("div",{staticClass:"border"},[r("div",{directives:[{name:"show",rawName:"v-show",value:""!==e.filterUser,expression:"filterUser!==''"}],staticClass:"treeHeight"},[r("el-tree",{ref:"tUser2",attrs:{"node-key":"id",props:e.propsTree,"show-checkbox":"",data:e.filterUsers},on:{check:e.handleTreeCheckChanged}})],1),r("el-row",{directives:[{name:"show",rawName:"v-show",value:""===e.filterUser,expression:"filterUser===''"}]},[r("el-col",{staticStyle:{"border-right":"1px solid #ddd"},attrs:{span:12}},[r("div",{staticClass:"treeHeight"},[r("el-tree",{attrs:{"node-key":"id",props:e.propsTree,load:e.loadDepts,lazy:"","default-expanded-keys":e.expandedDepts,"highlight-current":"","expand-on-click-node":!1},on:{"node-click":e.userDeptSelected}})],1)]),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"treeHeight"},[r("el-tree",{ref:"tUser1",attrs:{"node-key":"id",props:e.propsTree,"show-checkbox":"","check-strictly":!0,data:e.users},on:{check:e.handleTreeCheckChanged}})],1)])],1)],1)],1):e._e(),e.tabs.indexOf("role")>=0?r("el-tab-pane",{attrs:{label:"角色",name:"role"}},[r("el-input",{staticClass:"filter",attrs:{placeholder:"搜索角色",clearable:""},model:{value:e.filterRole,callback:function(t){e.filterRole=t},expression:"filterRole"}},[r("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"prefix"},slot:"prefix"})]),r("div",{staticClass:"border"},[r("div",{staticClass:"treeHeight"},[r("el-tree",{ref:"tRole",attrs:{"node-key":"id",props:e.propsTree,"show-checkbox":"",data:e.filterRoles},on:{check:e.handleTreeCheckChanged}})],1)])],1):e._e(),e.tabs.indexOf("field")>=0?r("el-tab-pane",{attrs:{label:"字段",name:"field"}},[r("div",{staticClass:"border border-plus"},[r("div",{staticClass:"treeHeight treeHeight-plus"},[r("el-tree",{ref:"tField",attrs:{"node-key":"id",props:e.propsTree,"show-checkbox":"",data:e.datas.fields},on:{check:e.handleTreeCheckChanged}})],1)])]):e._e(),e.tabs.indexOf("function")>=0?r("el-tab-pane",{attrs:{label:"函数",name:"function"}},[r("div",{staticClass:"border border-plus"},[r("div",{staticClass:"treeHeight treeHeight-plus"},e._l(e.functions,(function(t){return r("div",{key:t.id,staticClass:"funcBox"},[r("div",{staticClass:"funcTitle"},[e._v(" "+e._s(t.name)+" "),r("el-link",{attrs:{type:"primary"},on:{click:function(r){return e.funcAdd(t)}}},[e._v("+添加")])],1),r("div",{staticClass:"funcNote"},[e._v(e._s(t.note))])])})),0)])]):e._e()],1),e.footer?r("div",{staticClass:"footer"},[r("el-button",{attrs:{type:"default"},on:{click:e.onCancel}},[e._v("取消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.onConfirm}},[e._v("确定")])],1):e._e()],1)},u=[],y=(r("4de4"),r("4160"),r("c975"),r("a434"),r("b0c0"),r("a9e3"),r("ac1f"),r("466d"),r("159b"),{name:"ActorSelector",data:function(){return{activeTab:"dept",timer:null,propsTree:{label:"name",children:"children",isLeaf:"isLeaf"},tags:[],expandedDepts:["dept1"],filterDept:"",filterDepts:[],filterUser:"",filterUsers:[],users:[],filterRole:"",functions:[{id:"findDeptManager",name:"部门经理函数",note:"获取对应部门的所有经理。"},{id:"findRole",name:"查找角色函数",note:"获取“角色”中属于指定“部门”的所有成员。"}],checkedDeptKeys:[],checkedUserKeys:[],checkedRoleKeys:[],checkedFieldKeys:[],checkedFunctionKeys:[]}},computed:{filterRoles:function(){var e=this;return""===this.filterRole?this.datas.roles:this.datas.roles.filter((function(t){return t.name.match(e.filterRole)}))}},props:{datas:{type:Object,default:function(){return{}}},selectTags:{type:Array},dataProvider:{type:Function,default:null},tabs:{type:Array,default:function(){return["dept","user","role","field","function"]}},apiDelay:{type:Number,default:400},footer:{type:Boolean,default:!0},actorsNameMaxLength:{type:Number,default:25}},watch:{selectTags:{handler:function(e){e&&e.length>0&&(this.tags=e,this.refreshCheckedKeys(),this.setTreeCheckKeys(!0,!0,!0,!0))},immediate:!0}},methods:{getCheckedKeysArray:function(e){var t;return t="dept"===e?this.checkedDeptKeys:"user"===e?this.checkedUserKeys:"role"===e?this.checkedRoleKeys:"function"===e?this.checkedFunctionKeys:this.checkedFieldKeys,t},addCheckedKeys:function(e){var t=this.getCheckedKeysArray(e.type);t&&t.push(e.id)},removeCheckedKeys:function(e){var t=this.getCheckedKeysArray(e.type);if(t){var r=t.indexOf(e.id);t.splice(r,1)}},refreshCheckedKeys:function(){var e=this;this.checkedDeptKeys=[],this.checkedUserKeys=[],this.checkedRoleKeys=[],this.checkedFieldKeys=[],this.checkedFunctionKeys=[],this.tags.forEach((function(t){e.addCheckedKeys(t)}))},setTreeCheckKeys:function(e,t,r,i){this.$nextTick((function(){e&&(this.$refs.tDept1.setCheckedKeys(this.checkedDeptKeys),this.$refs.tDept2.setCheckedKeys(this.checkedDeptKeys)),t&&(this.$refs.tUser1.setCheckedKeys(this.checkedUserKeys),this.$refs.tUser2.setCheckedKeys(this.checkedUserKeys)),r&&this.$refs.tRole.setCheckedKeys(this.checkedRoleKeys),i&&this.$refs.tField.setCheckedKeys(this.checkedFieldKeys)}))},getActors:function(){for(var e="",t=0;t<this.tags.length;t++)e+=this.tags[t].name+",";var r=this.actorsNameMaxLength-3;e=e.length>r?e.substring(0,r)+"...":e.substring(0,e.length-1);var i={actorsName:e,actors:this.tags};return i},filterDeptChanged:function(){clearTimeout(this.timer);var e=this;this.timer=setTimeout((function(){if(e.dataProvider){if(""===e.filterDept)return;e.filterDepts=e.dataProvider("filterDept",e.filterDept),e.setTreeCheckKeys(!0)}}),this.apiDelay)},loadDepts:function(e,t){if(0===e.level)return t(this.datas.depts);if(1===e.level)return t(e.data.children);var r=[];return this.dataProvider&&(r=this.dataProvider("dept",e.data.id)),t(r)},filterUserChanged:function(){clearTimeout(this.timer);var e=this;this.timer=setTimeout((function(){if(e.dataProvider){if(""===e.filterUser)return;e.filterUsers=e.dataProvider("filterUser",e.filterUser),e.setTreeCheckKeys(!1,!0)}}),e.apiDelay)},userDeptSelected:function(e){this.dataProvider&&(this.users=this.dataProvider("user",e.id),this.setTreeCheckKeys(!1,!0))},handleTreeCheckChanged:function(e){var t=this.getCheckedKeysArray(e.type),r=t.indexOf(e.id)>=0;r?this.removeTags(e.type,e.id):this.addTags(e.type,e.id,e.name,!0)},addTags:function(e,t,r){var i={id:t,name:r,type:e};this.tags.push(i),this.addCheckedKeys(i)},removeTags:function(e,t){for(var r=0;r<this.tags.length;r++)if(this.tags[r].id===t&&this.tags[r].type===e){this.removeCheckedKeys(this.tags[r]),this.tags.splice(r,1);break}},funcAdd:function(e){for(var t={id:e.id,name:e.name,type:"func"},r=!1,i=0;i<this.tags.length;i++)if(this.tags[i].id===t.id&&this.tags[i].type===t.type){r=!0;break}r?this.$message({message:"不能重复添加",type:"warning",duration:2e3}):this.tags.push(t)},tagClose:function(e){this.removeTags(e.type,e.id),this.setTreeCheckKeys("dept"===e.type,"user"===e.type,"role"===e.type,"field"===e.type||"variable"===e.type)},onConfirm:function(){this.$emit("confirm",this.getActors())},onCancel:function(){this.$emit("cancel")}}}),m=y,v=(r("4317"),r("6bd4"),Object(n["a"])(m,h,u,!1,null,"5408bd1b",null)),b=v.exports,g={name:"Home",components:{actorSelector:b},data:function(){return{buttonName:"选择",dialogVisible:!1,actorInitData:{depts:[{id:"dept1",name:"总公司",type:"dept",isLeaf:!1,children:[{id:"dept2",name:"部门A",type:"dept",isLeaf:!1,children:[{id:"dept5",name:"部门H",type:"dept"}]},{id:"dept3",name:"部门B",type:"dept",isLeaf:!0,children:[]},{id:"dept4",name:"部门C",type:"dept",isLeaf:!0,children:[]}]}],roles:[{id:"role1",name:"角色1",type:"role"},{id:"role2",name:"角色2",type:"role"},{id:"role3",name:"角色3",type:"role"},{id:"role4",name:"角色4",type:"role"}],fields:[{id:"OwnId",name:"创建人",type:"field"},{id:"OwnDeptId",name:"所属部门",type:"field"},{id:"CreatedOwnId",name:"部门",type:"field"},{id:"Contact",name:"联系人",type:"variable"}]},dataProvider:null,actorSelectedData:[{id:"dept2",name:"部门A",type:"dept"},{id:"userdept21",name:"user1",type:"user"},{id:"OwnDeptId",name:"所属部门",type:"field"},{id:"Contact",name:"联系人",type:"variable"}]}},methods:{onActorConfirm:function(e){this.buttonName=e.actorsName,""===this.buttonName&&(this.buttonName="选择"),this.actorSelectedData=e.actors,this.dialogVisible=!1,console.error(JSON.stringify(e))}},mounted:function(){this.dataProvider=function(e,t){if(console.warn("get data"+e+","+t),"dept"===e)return[{id:t+"1",name:"部门"+t+"1",type:e,isLeaf:!0,children:[]}];if("filterDept"===e||"filterUser"===e||"user"===e){var r=e;return"filterDept"===e?r="dept":"filterUser"===e&&(r="user"),[{id:e+t+"1",name:e+"1",type:r,isLeaf:!0,children:[]},{id:e+t+"2",name:e+"2",type:r,isLeaf:!0,children:[]},{id:e+t+"3",name:e+"3",type:r,isLeaf:!0,children:[]}]}}}},k=g,C=Object(n["a"])(k,f,p,!1,null,"8881b7a2",null),x=C.exports;i["default"].use(d["a"]);var D=[{path:"/",name:"Home",component:x}],K=new d["a"]({routes:D}),T=K,w=r("2f62");i["default"].use(w["a"]);var _=new w["a"].Store({state:{},mutations:{},actions:{},modules:{}}),O=r("e5d9"),U=r("f825"),P=r.n(U),N=(r("f8ce"),r("cd22"),r("5c96")),A=r.n(N);r("0fae");i["default"].config.productionTip=!1,i["default"].use(O["a"]),i["default"].use(P.a),i["default"].use(A.a,{size:"small"}),new i["default"]({router:T,store:_,render:function(e){return e(c)}}).$mount("#app")},"6bd4":function(e,t,r){"use strict";r("df5a")},"7c55":function(e,t,r){"use strict";r("2395")},8216:function(e,t,r){},cd22:function(e,t,r){},df5a:function(e,t,r){}});